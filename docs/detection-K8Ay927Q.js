import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as g}from"./data-DOjEFDS4.js";const m=document.getElementById("colorPicker"),C=document.getElementById("result"),a=document.getElementById("train"),d=document.getElementById("load"),s=["purple","green","blue","red","yellow","orange","gray"],p=window.location.hostname==="localhost";p||f();m.addEventListener("change",o=>{k()});a.addEventListener("click",o=>{d.disabled=!0,a.disabled=!0,x()});d.addEventListener("click",o=>{f()});function f(){d.disabled=!0,a.disabled=!0,M()}let c="#451345";document.body.style.backgroundColor=c;function k(){c=m.value,document.body.style.backgroundColor=c,i()}function I(o){return{r:parseInt(o.substring(1,3),16),g:parseInt(o.substring(3,5),16),b:parseInt(o.substring(5,7),16)}}function B(o){return o.map(e=>h(e))}function h(o){const{r:e,g:n,b:r}=o;return[e/255,n/255,r/255]}function L(o){return o.map(e=>{const{name:n}=e;return s.indexOf(n)})}let t=null;function i(){tf.tidy(()=>{const o=tf.tensor2d([h(I(c))]),n=t.predict(o).argMax(1).dataSync()[0],r=s[n];console.log({color:r}),C.textContent="The color is: "+r})}function x(){const o=B(g.data),e=L(g.data),n=tf.tensor2d(o),r=tf.tensor1d(e,"int32"),u=tf.oneHot(r,s.length);r.dispose(),console.log({colors:o,colorTensor:n,labelTensor:r,ys:u}),t=tf.sequential();const b=tf.layers.dense({units:16,activation:"sigmoid",inputShape:[3]}),y=tf.layers.dense({units:s.length,activation:"softmax"});t.add(b),t.add(y);const v=tf.train.sgd(.2);return t.compile({optimizer:v,loss:"categoricalCrossentropy"}),t.fit(n,u,{epochs:70,callbacks:{onEpochEnd:async(l,E)=>{console.log(`Epoch ${l}: loss = ${E.loss}`),i()},onBatchEnd:tf.nextFrame},validationSplit:.1,shuffle:!0}).then(l=>{console.log(l),console.log("Model trained")}).then(l=>t.save("localstorage://color-model").then(()=>t.save("downloads://color-model")).then(()=>{console.log("Model saved")}))}function M(){const o=p?"localstorage://color-model":"https://khripunovpp.github.io/clr-rcgz/color-model.json";return Promise.resolve().then(()=>tf.loadLayersModel(o)).then(e=>(console.log("Model loaded"),e.summary(),t=e,i(),e)).catch(e=>{})}
