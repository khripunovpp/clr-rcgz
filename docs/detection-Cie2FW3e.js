import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as u}from"./data-DOjEFDS4.js";const g=document.getElementById("colorPicker"),C=document.getElementById("result"),c=document.getElementById("train"),m=document.getElementById("load"),l=["purple","green","blue","red","yellow","orange","gray"],p=window.location.hostname==="localhost";p||f();g.addEventListener("change",o=>{I()});c.addEventListener("click",o=>{m.disabled=!0,c.disabled=!0,x()});m.addEventListener("click",o=>{f()});function f(){c.disabled=!0,M()}let a="#000000";function I(){a=g.value,document.body.style.backgroundColor=a,d()}function k(o){return{r:parseInt(o.substring(1,3),16),g:parseInt(o.substring(3,5),16),b:parseInt(o.substring(5,7),16)}}function B(o){return o.map(e=>h(e))}function h(o){const{r:e,g:n,b:r}=o;return[e/255,n/255,r/255]}function L(o){return o.map(e=>{const{name:n}=e;return l.indexOf(n)})}let t=null;function d(){tf.tidy(()=>{const o=tf.tensor2d([h(k(a))]),n=t.predict(o).argMax(1).dataSync()[0],r=l[n];console.log({color:r}),C.textContent="The color is: "+r})}function x(){const o=B(u.data),e=L(u.data),n=tf.tensor2d(o),r=tf.tensor1d(e,"int32"),i=tf.oneHot(r,l.length);r.dispose(),console.log({colors:o,colorTensor:n,labelTensor:r,ys:i}),t=tf.sequential();const b=tf.layers.dense({units:16,activation:"sigmoid",inputShape:[3]}),y=tf.layers.dense({units:l.length,activation:"softmax"});t.add(b),t.add(y);const v=tf.train.sgd(.2);return t.compile({optimizer:v,loss:"categoricalCrossentropy"}),t.fit(n,i,{epochs:70,callbacks:{onEpochEnd:async(s,E)=>{console.log(`Epoch ${s}: loss = ${E.loss}`),d()},onBatchEnd:tf.nextFrame},validationSplit:.1,shuffle:!0}).then(s=>{console.log(s),console.log("Model trained")}).then(s=>t.save("localstorage://color-model").then(()=>t.save("downloads://color-model")).then(()=>{console.log("Model saved")}))}function M(){const o=p?"localstorage://color-model":"https://khripunovpp.github.io/clr-rcgz/color-model.json";return Promise.resolve().then(()=>tf.loadLayersModel(o)).then(e=>(console.log("Model loaded"),e.summary(),t=e,d(),e)).catch(e=>{})}
