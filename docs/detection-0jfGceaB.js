import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as u}from"./data-DOjEFDS4.js";const g=document.getElementById("colorPicker"),E=document.getElementById("result"),l=document.getElementById("train"),m=document.getElementById("load"),c=["purple","green","blue","red","yellow","orange","gray"],p=window.location.hostname==="localhost";p||(l.disabled=!0);g.addEventListener("change",o=>{C()});l.addEventListener("click",o=>{m.disabled=!0,l.disabled=!0,L()});m.addEventListener("click",o=>{l.disabled=!0,x()});let a="#000000";function C(){a=g.value,document.body.style.backgroundColor=a,d()}function I(o){return{r:parseInt(o.substring(1,3),16),g:parseInt(o.substring(3,5),16),b:parseInt(o.substring(5,7),16)}}function k(o){return o.map(e=>f(e))}function f(o){const{r:e,g:n,b:r}=o;return[e/255,n/255,r/255]}function B(o){return o.map(e=>{const{name:n}=e;return c.indexOf(n)})}let t=null;function d(){tf.tidy(()=>{const o=tf.tensor2d([f(I(a))]),n=t.predict(o).argMax(1).dataSync()[0],r=c[n];console.log({color:r}),E.textContent="The color is: "+r})}function L(){const o=k(u.data),e=B(u.data),n=tf.tensor2d(o),r=tf.tensor1d(e,"int32"),i=tf.oneHot(r,c.length);r.dispose(),console.log({colors:o,colorTensor:n,labelTensor:r,ys:i}),t=tf.sequential();const h=tf.layers.dense({units:16,activation:"sigmoid",inputShape:[3]}),b=tf.layers.dense({units:c.length,activation:"softmax"});t.add(h),t.add(b);const y=tf.train.sgd(.2);return t.compile({optimizer:y,loss:"categoricalCrossentropy"}),t.fit(n,i,{epochs:70,callbacks:{onEpochEnd:async(s,v)=>{console.log(`Epoch ${s}: loss = ${v.loss}`),d()},onBatchEnd:tf.nextFrame},validationSplit:.1,shuffle:!0}).then(s=>{console.log(s),console.log("Model trained")}).then(s=>t.save("localstorage://color-model").then(()=>t.save("downloads://color-model")).then(()=>{console.log("Model saved")}))}function x(){const o=p?"localstorage://color-model":"https://khripunovpp.github.io/clr-rcgz/color-model.json";return Promise.resolve().then(()=>tf.loadLayersModel(o)).then(e=>(console.log("Model loaded"),e.summary(),t=e,d(),e)).catch(e=>{})}
